@page "/"
@inject IJSRuntime JsRuntime
@inject NavigationManager NavigationManager

<PageTitle>Home - Under Construction</PageTitle>

<style>
    .dropdown-container {
        position: absolute;
        right: 10px;
        top: 10px;
        z-index: 20;
    }
    .rz-body {
        margin: 0 !important;
        padding: 0 !important;
        overflow: hidden !important;
    }

    .panel {
        position: absolute;
        width: 20vw;
        height: 25vh;
        z-index: 10;
        pointer-events: auto;
        background: rgba(255, 255, 255, 0.85);
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);
        transform-origin: center;
        transform: rotateX(37deg) rotateY(-12deg) rotateZ(17deg);
        background-size: cover;
        background-position: center;
        transition: transform 0.5s ease, opacity 0.5s ease;
    }

    .panel.home {
        background-image: url('home.jpg');
    }

    .panel.about {
        background-image: url('hobby.jpg');
    }

    .panel.contact {
        background-image: url('about.jpg');
    }

    .panel.projects {
        background-image: url('projects.jpg');
    }

    .panel:hover {
        transform: scale(1.05);
        opacity: 0.9;
    }
</style>

<div class="dropdown-container">
    <RadzenDropDown @bind-Value="_selectedGridDrawMethod"
                    Data="@_gridDrawMethods"
                    TextProperty="Value"
                    ValueProperty="Key"
                    Style="width: 200px"
                    Change="@UpdateGridMethod" />
</div>

<canvas id="gameCanvas"></canvas>
<div class="panel home" style="left: 18%; top: 9%;" @onclick="@NavigateToGitHub"></div>
<div class="panel about" style="left: 76%; top: 12%;"></div>
<div class="panel contact" style="left: 9%; top: 70%;"></div>
<div class="panel projects" style="left: 75%; top: 69%;"></div>

@code {
    int _selectedGridDrawMethod = (int)GridDrawMethods.GameOfLife;
    enum PanelType
    {
        Home,
        About,
        Contact,
        Projects
    }
    enum GridDrawMethods
    {
        GameOfLife,
        HeatEquation
    }
    Dictionary<int, string> _panelTypeToPath = new()
    {
        { (int)PanelType.Home, "/" },
        { (int)PanelType.About, "/About" },
        { (int)PanelType.Contact, "/Contact" },
        { (int)PanelType.Projects, "/Projects" }
    };
    Dictionary<int, string> _gridDrawMethodToJavascriptMethod = new()
    {
        { (int)GridDrawMethods.GameOfLife, "gameOfLife" },
        { (int)GridDrawMethods.HeatEquation, "heatEquation" }
    };
    List<KeyValuePair<int, string>> _gridDrawMethods = Enum.GetValues(typeof(GridDrawMethods))
        .Cast<GridDrawMethods>()
        .Select(e => new KeyValuePair<int, string>((int)e, e.ToString()))
        .ToList();
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JsRuntime.InvokeVoidAsync("initGameOfLife");
        }
        await base.OnAfterRenderAsync(firstRender);
    }
    private void NavigateToGitHub() => NavigationManager.NavigateTo("https://github.com/NilsInfiniteAnalytics");
    private async Task UpdateGridMethod()
    {
        await JsRuntime.InvokeVoidAsync("init" + _gridDrawMethodToJavascriptMethod[_selectedGridDrawMethod]);
    }
}